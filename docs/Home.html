<div class="wikidoc"><div class=wikidoc>   <h1>Welcome to CuttingEdge.Logging</h1> CuttingEdge.Logging is a library that helps programmers to output log statements to a variety of output targets in .NET applications. The design is based on the .NET 2.0 Provider Model. This means the library uses the same configuration and extensibility model.     <br>    <br>    <table><tbody>       <tr>         <td>           <h3>Contents</h3>            <ul>             <li><a href="#Overview">Overview</a> </li>              <li><a href="#Comparing">Comparing</a> </li>              <li><a href="#Usage">Usage</a>                 <ul>                 <li><a href="#CSharp_example">C# example</a> </li>                  <li><a href="#VB_example">VB example</a> </li>                  <li><a href="#Basic_configuration">Basic configuration</a> </li>                  <li><a href="#More_advanced_configuration">More advanced configuration</a> </li>               </ul>             </li>              <li><a href="#Extending_CuttingEdge_Logging">Extending CuttingEdge.Logging</a> </li>              <li><a href="#More_information">More information</a> </li>           </ul>         </td>       </tr>        <tr>         <td>&#160;</td>       </tr>     </tbody></table>    <h2>Overview<a name=Overview></a></h2> CuttingEdge.Logging is a configurable logging system and can even be plugged into ASP.NET applications without a republish or recompile. The library is written in C# .NET 3.5 in Visual Studio 2008, but the library can also be used by .NET 2.0 applications. It can be used for several types of .NET applications, such as server and desktop applications. However, Compact Edition and Silverlight are not supported.     <h2>Comparing<a name=Comparing></a></h2> CuttingEdge.Logging differentiates with other logging frameworks such as <a href="http://logging.apache.org/">log4net<span></span></a> and the <a href="http://msdn.microsoft.com/en-us/library/cc511708.aspx">Enterprise Library Logging Application Block<span></span></a> (LAB) in it's simplicity. CuttingEdge.Logging does not allow you to configure layouts (log4net) or formatters (LAB) to control the way events are written. Neither does it support filters (log4net and LAB) to determine which event should be logged and where to. log4net even allows you to change configuration, without an application restart (<a href="http://logging.apache.org/log4net/release/features.html#Dynamic Configuration">dynamic configuration<span></span></a>) and it's compatible with Mono, .NET CE and even SSCLI.     <br>    <br>While those two frameworks are highly configurable and composable; they are complex to configure and use. CuttingEdge.Logging is designed with the <a href="http://en.wikipedia.org/wiki/KISS_principle">KISS<span></span></a> principle (keep it small, simple) in mind. You won't have to read large manuals and when you are familiar with the .NET provider model, you'll feel right at home.     <h2>Usage<a name=Usage></a></h2>    <h3>C# example<a name="CSharp_example"></a></h3> The following example shows some code snippets of what code a C# developer could write using CuttingEdge.Logging.     <br>    <br>    <div style="background-color:white;color:black">     <pre><span style="color:green">// Log an information event to the default provider.</span>
Logger.Log(<span style="color:#a31515">&quot;Operation completed successfully.&quot;</span>);
    
<span style="color:green">// Log a warning to the default provider.</span>
Logger.Log(LoggingEventType.Warning, <span style="color:#a31515">&quot;Server is currently under high load&quot;</span>);
    
<span style="color:green">// Log an error event with source location to the default provider.</span>
Logger.Log(LoggingEventType.Error,
    <span style="color:#a31515">&quot;Something went wrong.&quot;</span>, MethodBase.GetCurrentMethod());
    
<span style="color:blue">try</span>
{
    <span style="color:blue">this</span>.DoSomeAction();
}
<span style="color:blue">catch</span> (Exception ex)
{
    <span style="color:green">// Log an exception to the default provider.</span>
    Logger.Log(ex);
    <span style="color:blue">throw</span>;
}
    
<span style="color:green">// Log an information event to the default provider.</span>
<span style="color:green">// This is equivalent to calling 'Logger.Log'.</span>
Logger.Provider.Log(<span style="color:#a31515">&quot;Success!&quot;</span>, MethodBase.GetCurrentMethod());
    
<span style="color:green">// Log to an alternative provider by name (note that name is case-insensitive).</span>
LoggingProviderBase xmlLogger = Logger.Providers[<span style="color:#a31515">&quot;XmlLogger&quot;</span>];
xmlLogger.Log(<span style="color:#a31515">&quot;Success!&quot;</span>);
    
<span style="color:green">// Display all configured providers</span>
<span style="color:blue">foreach</span> (LoggingProviderBase loggingProvider <span style="color:blue">in</span> Logger.Providers)
{
    Console.WriteLine(loggingProvider.Name);
}
    
<span style="color:green">// Logging providers can be chained. Using fallback providers.</span>
<span style="color:green">// This way you can ensure a event is being logged, even if the</span>
<span style="color:green">// default provider fails.</span>
LoggingProviderBase fallbackProvider = Logger.Provider.FallbackProvider;
<span style="color:blue">if</span> (fallbackProvider != <span style="color:blue">null</span>)
{
    fallbackProvider.Log(LoggingEventType.Warning, <span style="color:#a31515">&quot;This is a warning.&quot;</span>);
}</pre>
  </div>

  <h3>VB.NET example<a name="VB_example"></a></h3>
The following example shows some code snippets of what code a VB.NET developer could write using CuttingEdge.Logging. 

  <br>

  <br>

  <div style="background-color:white;color:black">
    <pre><span style="color:green">' Log an information event to the default provider. </span>
Logger.Log(<span style="color:#a31515">&quot;Operation completed successfully.&quot;</span>)
    
<span style="color:green">' Log a warning to the default provider. </span>
Logger.Log(LoggingEventType.Warning, <span style="color:#a31515">&quot;Server is currently under high load&quot;</span>)
    
<span style="color:green">' Log an error event with source location to the default provider. </span>
Logger.Log(LoggingEventType.[<span style="color:blue">Error</span>], _
	<span style="color:#a31515">&quot;Something went wrong.&quot;</span>, MethodBase.GetCurrentMethod())
    
<span style="color:blue">Try</span>
	DoSomeAction()
<span style="color:blue">Catch</span> ex <span style="color:blue">As</span> Exception
	<span style="color:green">' Log an exception to the default provider. </span>
	Logger.Log(ex)
	<span style="color:blue">Throw</span>
<span style="color:blue">End</span> <span style="color:blue">Try</span>
    
<span style="color:green">' Log an information event to the default provider. </span>
<span style="color:green">' This is equivalent to calling 'Logger.Log'. </span>
Logger.Provider.Log(<span style="color:#a31515">&quot;Success!&quot;</span>, MethodBase.GetCurrentMethod())
    
<span style="color:green">' Log to an alternative provider by name (note that name is case-insensitive).</span>
<span style="color:blue">Dim</span> xmlLogger <span style="color:blue">As</span> LoggingProviderBase = Logger.Providers(<span style="color:#a31515">&quot;XmlLogger&quot;</span>)
xmlLogger.Log(<span style="color:#a31515">&quot;Success!&quot;</span>)

<span style="color:green">' Display all configured providers </span>
<span style="color:blue">For</span> <span style="color:blue">Each</span> loggingProvider <span style="color:blue">As</span> LoggingProviderBase <span style="color:blue">In</span> Logger.Providers
	Console.WriteLine(loggingProvider.Name)
<span style="color:blue">Next</span>
    
<span style="color:green">' Logging providers can be chained. Using fallback providers. </span>
<span style="color:green">' This way you can ensure a event is being logged, even if the </span>
<span style="color:green">' default provider fails. </span>
<span style="color:blue">Dim</span> fallbackProvider <span style="color:blue">As</span> LoggingProviderBase = Logger.Provider.FallbackProvider
<span style="color:blue">If</span> fallbackProvider <span style="color:blue">IsNot</span> <span style="color:blue">Nothing</span> <span style="color:blue">Then</span>
	fallbackProvider.Log(LoggingEventType.Warning, <span style="color:#a31515">&quot;This is a warning.&quot;</span>)
<span style="color:blue">End</span> <span style="color:blue">If</span></pre>
  </div>

  <h3>Basic configuration<a name="Basic_configuration"></a></h3>
The following example shows an app.config of a typical application that uses CuttingEdge.Logging. The configuration in this example allows logging to the Windows event log by configuring a <a href="http://logging.cuttingedge.it/ReferenceLibrary/T_CuttingEdge_Logging_WindowsEventLogLoggingProvider.htm">WindowsEventLogLoggingProvider<span></span></a>. 

  <br>

  <br>

  <div style="background-color:white;color:black">
    <pre><span style="color:blue">&lt;?</span><span style="color:#a31515">xml</span> <span style="color:red">version</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1.0</span><span style="color:black">&quot;</span><span style="color:blue">?&gt;</span>
<span style="color:blue">&lt;</span><span style="color:#a31515">configuration</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">configSections</span><span style="color:blue">&gt;</span>
    <span style="color:green">&lt;!-- The following section should be added to the configSections. --&gt;</span>
    <span style="color:blue">&lt;</span><span style="color:#a31515">section</span> <span style="color:red">name</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">logging</span><span style="color:black">&quot;</span>
      <span style="color:red">type</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">CuttingEdge.Logging.LoggingSection, CuttingEdge.Logging</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
  <span style="color:blue">&lt;/</span><span style="color:#a31515">configSections</span><span style="color:blue">&gt;</span>
  <span style="color:green">&lt;!-- the logging section allows you to configure logging providers --&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">logging</span> <span style="color:red">defaultProvider</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">WindowsEventLogLoggingProvider</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;</span><span style="color:#a31515">providers</span><span style="color:blue">&gt;</span>
      <span style="color:green">&lt;!-- The WindowsEventLogLoggingProvider writes to the event log --&gt;</span>
      <span style="color:blue">&lt;</span><span style="color:#a31515">add</span>
        <span style="color:red">name</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">WindowsEventLogLoggingProvider</span><span style="color:black">&quot;</span>
        <span style="color:red">type</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">CuttingEdge.Logging.WindowsEventLogLoggingProvider, CuttingEdge.Logging</span><span style="color:black">&quot;</span>
        <span style="color:red">source</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">MyWebApplication</span><span style="color:black">&quot;</span>
        <span style="color:red">logName</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">MyWebApplication</span><span style="color:black">&quot;</span>
      <span style="color:blue">/&gt;</span>    
    <span style="color:blue">&lt;/</span><span style="color:#a31515">providers</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;/</span><span style="color:#a31515">logging</span><span style="color:blue">&gt;</span>
<span style="color:blue">&lt;/</span><span style="color:#a31515">configuration</span><span style="color:blue">&gt;</span></pre>
  </div>
You can find more configuration examples on the <a href="http://logging.codeplex.com/wikipage?title=Configuration&referringTitle=Home">configuration examples page</a>. 

  <br>

  <h3>More advanced configuration<a name="More_advanced_configuration"></a></h3>
The example below shows how to configure the Logging Provider model in a web environment to log to a SQL Server database and use the Windows event log as <a href="http://logging.cuttingedge.it/ReferenceLibrary/P_CuttingEdge_Logging_LoggingProviderBase_FallbackProvider.htm">fallback logging store<span></span></a>. The <a href="http://logging.cuttingedge.it/ReferenceLibrary/T_CuttingEdge_Logging_Web_AspNetSqlLoggingProvider.htm">AspNetSqlLoggingProvider<span></span></a> is configured with the <a href="http://logging.cuttingedge.it/ReferenceLibrary/P_CuttingEdge_Logging_LoggingProviderBase_Threshold.htm">threshold<span></span></a> set to <i>Information</i>, which means that <i>Debug</i> events will not be logged. The <a href="http://logging.cuttingedge.it/ReferenceLibrary/T_CuttingEdge_Logging_WindowsEventLogLoggingProvider.htm">WindowsEventLogLoggingProvider<span></span></a> has its threshold set to <i>Warning</i>, which means that <i>Debug</i> and <i>Information</i> events will not be logged. By configuring the <a href="http://logging.cuttingedge.it/ReferenceLibrary/T_CuttingEdge_Logging_Web_AspNetExceptionLoggingModule.htm">AspNetExceptionLoggingModule<span></span></a> http module, the web application ensures that unhandled exceptions will get logged automatically. The configured <a href="http://logging.cuttingedge.it/ReferenceLibrary/T_CuttingEdge_Logging_Web_LoggingWebEventProvider.htm">LoggingWebEventProvider<span></span></a> will route web events, raised by the ASP.NET health monitoring system, to the Logging infrastructure. 

  <br>

  <br>The <b>AspNetSqlLoggingProvider</b> is configured with <i>initializeSchema=&quot;True&quot;</i>. This means it will try to create the necessary tables and stored procedures needed for it to operate. This is the alternative for manually running the SQL scripts that are supplied with the release. For initialization to succeed, the supplied connection must have the proper rights on the database. The switch must be removed after initialization; the provider will throw an exception when the database schema already exists. 

  <br>

  <br>

  <div style="background-color:white;color:black">
    <pre><span style="color:blue">&lt;?</span><span style="color:#a31515">xml</span> <span style="color:red">version</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1.0</span><span style="color:black">&quot;</span><span style="color:blue">?&gt;</span>
<span style="color:blue">&lt;</span><span style="color:#a31515">configuration</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">configSections</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;</span><span style="color:#a31515">section</span> <span style="color:red">name</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">logging</span><span style="color:black">&quot;</span> 
      <span style="color:red">type</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">CuttingEdge.Logging.LoggingSection, CuttingEdge.Logging</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
  <span style="color:blue">&lt;/</span><span style="color:#a31515">configSections</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">connectionStrings</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;</span><span style="color:#a31515">add</span> <span style="color:red">name</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">SqlLogging</span><span style="color:black">&quot;</span>
        <span style="color:red">connectionString</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Data Source=.;Integrated Security=SSPI;Initial Catalog=Logging;</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
  <span style="color:blue">&lt;/</span><span style="color:#a31515">connectionStrings</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">logging</span> <span style="color:red">defaultProvider</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">AspNetSqlLoggingProvider</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;</span><span style="color:#a31515">providers</span><span style="color:blue">&gt;</span>
      <span style="color:blue">&lt;</span><span style="color:#a31515">add</span>
        <span style="color:red">name</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">AspNetSqlLoggingProvider</span><span style="color:black">&quot;</span>
        <span style="color:red">type</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">CuttingEdge.Logging.Web.AspNetSqlLoggingProvider, CuttingEdge.Logging</span><span style="color:black">&quot;</span>
        <span style="color:red">fallbackProvider</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">WindowsEventLogLoggingProvider</span><span style="color:black">&quot;</span>
        <span style="color:red">description</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">ASP.NET SQL logging provider example</span><span style="color:black">&quot;</span>
        <span style="color:red">connectionStringName</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">SqlLogging</span><span style="color:black">&quot;</span>
        <span style="color:red">threshold</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Information</span><span style="color:black">&quot;</span>
        <span style="color:red">initializeSchema</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">True</span><span style="color:black">&quot;</span>
        <span style="color:red">applicationName</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">[MyWebApplication]</span><span style="color:black">&quot;</span>
        <span style="color:red">userNameRetrievalType</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Membership</span><span style="color:black">&quot;</span>
        <span style="color:red">logQueryString</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">True</span><span style="color:black">&quot;</span>
        <span style="color:red">logFormData</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">False</span><span style="color:black">&quot;</span>
      <span style="color:blue">/&gt;</span>
      <span style="color:blue">&lt;</span><span style="color:#a31515">add</span>
        <span style="color:red">name</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">WindowsEventLogLoggingProvider</span><span style="color:black">&quot;</span>
        <span style="color:red">type</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">CuttingEdge.Logging.WindowsEventLogLoggingProvider, CuttingEdge.Logging</span><span style="color:black">&quot;</span>
        <span style="color:red">threshold</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Warning</span><span style="color:black">&quot;</span>
        <span style="color:red">source</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">MyWebApplication</span><span style="color:black">&quot;</span>
        <span style="color:red">logName</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">MyWebApplication</span><span style="color:black">&quot;</span>
      <span style="color:blue">/&gt;</span>
    <span style="color:blue">&lt;/</span><span style="color:#a31515">providers</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;/</span><span style="color:#a31515">logging</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">system.web</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;</span><span style="color:#a31515">httpModules</span><span style="color:blue">&gt;</span>
      <span style="color:green">&lt;!--
        We're defining the AspNetExceptionLoggingModule here.
        This http module will always log to the default logger.
      --&gt;</span>
      <span style="color:blue">&lt;</span><span style="color:#a31515">add</span>
        <span style="color:red">name</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">UnhandledExceptionLogger</span><span style="color:black">&quot;</span>
        <span style="color:red">type</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">CuttingEdge.Logging.Web.AspNetExceptionLoggingModule, CuttingEdge.Logging</span><span style="color:black">&quot;</span>
      <span style="color:blue">/&gt;</span>
    <span style="color:blue">&lt;/</span><span style="color:#a31515">httpModules</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;</span><span style="color:#a31515">healthMonitoring</span> <span style="color:red">heartbeatInterval</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">0</span><span style="color:black">&quot;</span> <span style="color:red">enabled</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">true</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
      <span style="color:blue">&lt;</span><span style="color:#a31515">providers</span><span style="color:blue">&gt;</span>
        <span style="color:green">&lt;!-- We're configuring the web event provider here. --&gt;</span>
        <span style="color:blue">&lt;</span><span style="color:#a31515">add</span>
          <span style="color:red">name</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">LoggingWebEventProvider</span><span style="color:black">&quot;</span>
          <span style="color:red">type</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">CuttingEdge.Logging.Web.LoggingWebEventProvider, CuttingEdge.Logging</span><span style="color:black">&quot;</span>
          <span style="color:red">loggingProvider</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">AspNetSqlLoggingProvider</span><span style="color:black">&quot;</span>
        <span style="color:blue">/&gt;</span>
      <span style="color:blue">&lt;/</span><span style="color:#a31515">providers</span><span style="color:blue">&gt;</span>
      <span style="color:blue">&lt;</span><span style="color:#a31515">rules</span><span style="color:blue">&gt;</span>
        <span style="color:blue">&lt;</span><span style="color:#a31515">add</span>
          <span style="color:red">name</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Custom Event Provider</span><span style="color:black">&quot;</span>
          <span style="color:red">eventName</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">All Events</span><span style="color:black">&quot;</span>
          <span style="color:red">provider</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">LoggingWebEventProvider</span><span style="color:black">&quot;</span>
          <span style="color:red">profile</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">Default</span><span style="color:black">&quot;</span>
        <span style="color:blue">/&gt;</span>
      <span style="color:blue">&lt;/</span><span style="color:#a31515">rules</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;/</span><span style="color:#a31515">healthMonitoring</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;/</span><span style="color:#a31515">system.web</span><span style="color:blue">&gt;</span>
<span style="color:blue">&lt;/</span><span style="color:#a31515">configuration</span><span style="color:blue">&gt;</span></pre>
  </div>
You can find more configuration examples on the <a href="http://logging.codeplex.com/wikipage?title=Configuration&referringTitle=Home">configuration examples page</a>. 

  <br>

  <h2>Extending CuttingEdge.Logging<a name="Extending_CuttingEdge_Logging"></a></h2>
The following example shows how to extend CuttingEdge.Logging by defining a logger that logs to the file system. <em>Note however that this is an illustrative example. The library contains an XmlFileLoggingProvider for writing log information in an XML format to the file system, and it contains an FileLoggingProviderBase that can act as base class for providers that write to the file system.</em> 

  <br>

  <br>

  <div style="background-color:white;color:black">
    <pre><span style="color:blue">using</span> System;
<span style="color:blue">using</span> System.Collections.Specialized;
<span style="color:blue">using</span> System.Configuration.Provider;
<span style="color:blue">using</span> System.IO;
    
<span style="color:blue">using</span> CuttingEdge.Logging;
    
<span style="color:blue">namespace</span> MyLoggingProviders
{
    <span style="color:blue">public</span> <span style="color:blue">class</span> MyFileLoggingProvider : LoggingProviderBase
    {
        <span style="color:blue">private</span> <span style="color:blue">string</span> path;
        
        <span style="color:blue">public</span> <span style="color:blue">override</span> <span style="color:blue">void</span> Initialize(<span style="color:blue">string</span> name,
            NameValueCollection config)
        {
            <span style="color:blue">if</span> (config == <span style="color:blue">null</span>)
            {
                <span style="color:blue">throw</span> <span style="color:blue">new</span> ArgumentNullException(<span style="color:#a31515">&quot;config&quot;</span>);
            }
            
            <span style="color:green">// Call base initialize first.</span>
            <span style="color:blue">base</span>.Initialize(name, config);
            
            <span style="color:green">// Performing provider specific initialization.</span>
            <span style="color:blue">this</span>.InitializePath(name, config);
            
            <span style="color:green">// Always call this method last.</span>
            <span style="color:blue">this</span>.CheckForUnrecognizedAttributes(name, config);
        }
        
        <span style="color:blue">protected</span> <span style="color:blue">override</span> <span style="color:blue">object</span> LogInternal(LogEntry entry)
        {
            DateTime now = DateTime.Now;
            
            <span style="color:blue">string</span> line = String.Format(<span style="color:#a31515">&quot;{0} {1}\t{2}\t{3}\t{4}\n&quot;</span>,
                now.ToShortDateString(), now.ToShortTimeString(),
                entry.Severity, entry.Message, entry.Exception);
            
            File.AppendAllText(<span style="color:blue">this</span>.path, line);
            <span style="color:blue">return</span> <span style="color:blue">null</span>;
        }
        
        <span style="color:blue">private</span> <span style="color:blue">void</span> InitializePath(<span style="color:blue">string</span> name,
            NameValueCollection config)
        {
            <span style="color:blue">this</span>.path = config[<span style="color:#a31515">&quot;path&quot;</span>];
            
            <span style="color:blue">if</span> (String.IsNullOrEmpty(<span style="color:blue">this</span>.path))
            {
                <span style="color:blue">throw</span> <span style="color:blue">new</span> ProviderException(<span style="color:blue">string</span>.Format(
                    <span style="color:#a31515">&quot;Empty or missing 'path' attribute in &quot;</span> +
                    <span style="color:#a31515">&quot;provider '{0}' in config file.&quot;</span>, name));
            }
            
            config.Remove(<span style="color:#a31515">&quot;path&quot;</span>);
        }
    }
}</pre>
  </div>

  <br>The following example shows the configuration for the logging provider that we've defined above: 

  <br>

  <br>

  <div style="background-color:white;color:black">
    <pre><span style="color:blue">&lt;?</span><span style="color:#a31515">xml</span> <span style="color:red">version</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">1.0</span><span style="color:black">&quot;</span><span style="color:blue">?&gt;</span>
<span style="color:blue">&lt;</span><span style="color:#a31515">configuration</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">configSections</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;</span><span style="color:#a31515">section</span> <span style="color:red">name</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">logging</span><span style="color:black">&quot;</span>
      <span style="color:red">type</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">CuttingEdge.Logging.LoggingSection, CuttingEdge.Logging</span><span style="color:black">&quot;</span> <span style="color:blue">/&gt;</span>
  <span style="color:blue">&lt;/</span><span style="color:#a31515">configSections</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;</span><span style="color:#a31515">logging</span> <span style="color:red">defaultProvider</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">MyFileLoggingProvider</span><span style="color:black">&quot;</span><span style="color:blue">&gt;</span>
    <span style="color:blue">&lt;</span><span style="color:#a31515">providers</span><span style="color:blue">&gt;</span>
      <span style="color:blue">&lt;</span><span style="color:#a31515">add</span>
         <span style="color:red">name</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">MyFileLoggingProvider</span><span style="color:black">&quot;</span>
         <span style="color:red">type</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">MyLoggingProviders.MyFileLoggingProvider, MyLoggingProviders</span><span style="color:black">&quot;</span>
         <span style="color:red">path</span><span style="color:blue">=</span><span style="color:black">&quot;</span><span style="color:blue">c:\mylog.txt</span><span style="color:black">&quot;</span>
      <span style="color:blue">/&gt;</span>
    <span style="color:blue">&lt;/</span><span style="color:#a31515">providers</span><span style="color:blue">&gt;</span>
  <span style="color:blue">&lt;/</span><span style="color:#a31515">logging</span><span style="color:blue">&gt;</span>
<span style="color:blue">&lt;/</span><span style="color:#a31515">configuration</span><span style="color:blue">&gt;</span></pre>
  </div>
Please note that this example expects the MyFileLoggingProvider to be placed in an assembly called <i>MyLoggingProviders</i>. Change this assembly name to the name of the assembly / project where you place the MyFileLoggingProvider. Also note that this example is a bit naive and will not work properly in a multi-threaded environment, such as ASP.NET. Again, please note that this example is illustrative. Please use the XmlFileLoggingProvider or it’s base class FileLoggingProviderBase to create a logger that writes to the file system. 

  <br>

  <h2>More information<a name="More_information"></a></h2>
For more information about CuttingEdge.Logging, please visit the following links: 

  <ul>
    <li><a href="http://logging.codeplex.com/documentation?referringTitle=Home">CuttingEdge.Logging documentation</a> </li>

    <li><a href="http://logging.codeplex.com/wikipage?title=Configuration&referringTitle=Home">CuttingEdge.Logging configuration examples</a> </li>

    <li><a href="http://logging.cuttingedge.it/ReferenceLibrary/">CuttingEdge.Logging Reference Library<span></span></a> </li>
  </ul>
For more information about the ASP.NET provider model, please visit the following links: 

  <ul>
    <li><a href="http://msdn.microsoft.com/en-us/library/aa479030.aspx">.ASP.NET 2.0 Provider Model: Introduction to the Provider Model<span></span></a> </li>

    <li><a href="http://msdn.microsoft.com/en-us/asp.net/aa336558.aspx">.A Provider Toolkit<span></span></a> </li>
  </ul>

  <h2>This project is supported by:</h2>
  <a href="http://www.ncover.com"><img title=NCover alt=NCover src="http://i3.codeplex.com/download?ProjectName=logging&DownloadId=98386"></a> <a href="http://www.ndepend.com"><img title=NDepend alt=NDepend src="http://i3.codeplex.com/download?ProjectName=logging&DownloadId=98388"></a></div>

<div></div></div><div class="ClearBoth"></div>